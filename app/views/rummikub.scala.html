@(controller: de.htwg.se.rummi.controller.ControllerInterface)

@tile_colour(grid: String, row: Int, col: Int) = @{
    var c = ""
    if(grid == "F") {
        if(!controller.field.tiles.get(row, col).isEmpty) {
            c =
                    controller.field.tiles(row, col).colour.name match {
                        case "RED" => "red"
                        case "BLUE" => "blue"
                        case "GREEN" => "green"
                        case "YELLOW" => "yellow"
                        case "WHITE" => "joker"
                    }
        }
    }
    else if(grid == "R") {
        if(!controller.rackOfActivePlayer.tiles.get(row, col).isEmpty) {
            c =
                    controller.rackOfActivePlayer.tiles(row, col).colour.name match {
                        case "RED" => "red"
                        case "BLUE" => "blue"
                        case "GREEN" => "green"
                        case "YELLOW" => "yellow"
                        case "WHITE" => "joker"
                    }
        }
    }
}

@player_name = @{
    controller.activePlayer.name
}
@game_state = @{
    controller.getGameState.toString
}

@fieldRows = @{
    controller.field.ROWS
}
@fieldCols = @{
    controller.field.COLS
}

@rackRows = @{
    controller.rackOfActivePlayer.ROWS
}
@rackCols = @{
    controller.rackOfActivePlayer.COLS
}

@main("Rummikub") {

    <div id="header">
        <div class="container">
            <a href="/" class="logo">
                <img src="@routes.Assets.versioned("images/rummy.png")">
                <h1>Rummikub the Game</h1>
            </a>
            <ul class="nav">
                <li>
                    <a href="/about">Rules</a>
                </li>
            </ul>
        </div>
    </div>
    <div class="gamecontainer">
        <div class="container">
            <div class="game">
                <div class="grid">
                @for(row <- 1 to fieldRows) {
                    <div class="row">
                    @for(col <- 1 to fieldCols) {
                        <span class="cell">
                        @{
                            controller.field.getTileAt(row, col) match {
                                case Some(t) => t.number
                                case None => "_"
                            }
                        }
                        </span>
                    }
                    </div>
                }
                </div>

                <div class="grid">
                @for(row <- 1 to fieldRows) {
                    <div class="row">
                    @for(col <- 1 to fieldCols) {
                        <span class="cell">
                        @{
                            controller.rackOfActivePlayer.getTileAt(row, col) match {
                                case Some(t) => {
                                    t.colour.name match {
                                        case "RED" => <span class="red">{t.number}</span>
                                        case "BLUE" => <span class="blue">{t.number}</span>
                                        case "YELLOW" => <span class="yellow">{t.number}</span>
                                        case "GREEN" => <span class="green">{t.number}</span>
                                        case "WHITE" => <span class="joker">J</span>
                                    }
                                }
                                case None => "_"
                            }
                        }
                        </span>
                    }
                    </div>
                }
                </div>
            </div>

            <div class="ctrl-container">
                <div class="player">
                    <p>
                        <b>Active Player: </b> @player_name
                    </p>
                </div>
                <div class="gameState">
                    <p><b>Game State: </b> @game_state.toLowerCase</p>
                </div>
                <a class="btn sort" href="/sorted">
                    <div class="inner">Sort</div>
                    <div class="inner-back">troS</div>
                </a>
                <a class="btn draw" href="/draw"><div class="inner">Draw</div></a>
                <a class="btn undo" href="/undo"><div class="inner">Undo</div></a>
                <a class="btn redo" href="/redo"><div class="inner">Redo</div></a>
                <a class="btn finish" href="/switchPlayer"><div class="inner">Finish Turn</div></a>
            </div>
        </div>

    </div>
    <div id="footer">
        <a href="/" class="logo">
            <img src="@routes.Assets.versioned("images/rummy.png")">
        </a>
        <ul class="nav">
            <li>
                <a href="/about">Rules</a>
            </li>
        </ul>
    </div>
}